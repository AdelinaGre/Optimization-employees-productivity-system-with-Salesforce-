# -*- coding: utf-8 -*-
"""employee_garments_dataset_cleaned.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1v2Fs8THc4nP_VsMc80O6WldBLOkmgIBy
"""

import numpy as np
import pandas as pd

from google.colab import files
uploaded = files.upload()

df = pd.read_csv('garments_dataset_clean.csv')

df.info()
df.describe()
df.shape
df.head()

df.isnull().sum()/len(df)*100

df.replace({'wip': np.nan}, 0, inplace=True)

df.head()

df.duplicated().sum()

df.dtypes

df['date'] = pd.to_datetime(df['date'])

df.to_csv('garments_dataset_clean.csv')

from google.colab import files

files.download('garments_dataset_clean.csv')

df['quarter'] = df['quarter'].str.extract(r'(\d+)').astype(int)



df.head()

import pandas as pd


df = pd.read_csv("garments_dataset_clean.csv")


df = df.astype({
    "date": "string",                   # în Salesforce e Date, îl poți lăsa string; îl poți converti ulterior
    "day": "string",                    # Text(25)
    "department": "string",             # Text(25)
    "team": "int64",                    # Number(18, 0)
    "targeted_productivity": "float64", # Percent(15, 3)
    "smv": "float64",                   # Number(15, 3)
    "wip": "float64",                   # Number(18, 0)
    "over_time": "int64",               # Number(18, 0)
    "incentive": "int64",               # dacă ai acest câmp în Salesforce, Number(18, 0)
    "idle_time": "float64",             # Number(18, 0)
    "idle_men": "int64",                # Number(18, 0)
    "no_of_style_change": "int64",      # Number(18, 0)
    "no_of_workers": "float64",         # Number(15, 3)
    "actual_productivity": "float64",   # Number(10, 6)
})


df["quarter"] = df["quarter"].astype(str).str.extract(r'(\d+)').astype(float).fillna(0).astype(int)


df["date"] = pd.to_datetime(df["date"], errors="coerce").dt.strftime("%Y-%m-%d")

df.to_csv("garments_dataset_clean.csv", index=False)
from google.colab import files

files.download('garments_dataset_clean.csv')
print("✅ Fișierul a fost convertit și salvat ca 'garments_dataset_salesforce_ready.csv'")

df.dtypes

df.head(10)

